<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.text.*?>

<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="oop.section6.national_park_management.Wildlife_RD.ConservationDataAnalyst.ThreatLevelReportController"
            prefHeight="800.0" prefWidth="1200.0"
            styleClass="main-anchor-pane">

    <VBox spacing="20" AnchorPane.topAnchor="20.0" AnchorPane.leftAnchor="20.0" 
          AnchorPane.rightAnchor="20.0" AnchorPane.bottomAnchor="20.0">

        <!-- Header with Back Button -->
        <HBox spacing="20" alignment="CENTER_LEFT">
            <Button fx:id="backButton" text="← Back to Dashboard" onAction="#handleBack" styleClass="back-button"/>
            <Label text="Threat Level Analysis Report" styleClass="page-title">
                <font>
                    <Font name="System Bold" size="24.0"/>
                </font>
            </Label>
        </HBox>

        <!-- Report Configuration -->
        <TitledPane text="Report Configuration" expanded="true">
            <GridPane hgap="15" vgap="10">
                <padding>
                    <Insets topRightBottomLeft="15"/>
                </padding>

                <!-- Time Period Selection -->
                <Label text="Time Period:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0">
                    <DatePicker fx:id="startDatePicker" promptText="Start Date"/>
                    <DatePicker fx:id="endDatePicker" promptText="End Date"/>
                    <ComboBox fx:id="presetPeriodCombo" promptText="Preset Periods"/>
                </HBox>

                <!-- Region Selection -->
                <Label text="Region:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                <ComboBox fx:id="regionCombo" promptText="Select Region" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                <!-- Report Options -->
                <Label text="Include in Report:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="2">
                    <CheckBox fx:id="includeChartCheckbox" text="Pie Chart" selected="true"/>
                    <CheckBox fx:id="includeTableCheckbox" text="Detailed Table" selected="true"/>
                    <CheckBox fx:id="includeTrendCheckbox" text="Threat Level Trends"/>
                    <CheckBox fx:id="includeRecommendationsCheckbox" text="Recommendations"/>
                </VBox>

                <!-- PDF Options -->
                <Label text="PDF Options:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="3">
                    <ComboBox fx:id="paperSizeCombo" promptText="Paper Size"/>
                    <CheckBox fx:id="includeHeaderFooterCheckbox" text="Include Header/Footer" selected="true"/>
                    <CheckBox fx:id="addWatermarkCheckbox" text="Add Watermark"/>
                    <TextField fx:id="reportTitleField" promptText="Custom Report Title"/>
                </VBox>
            </GridPane>
        </TitledPane>

        <!-- Charts and Data Section -->
        <SplitPane dividerPositions="0.6" VBox.vgrow="ALWAYS">
            <!-- Left Side - Chart -->
            <VBox spacing="10">
                <Label text="Threat Level Distribution" styleClass="section-header"/>
                <PieChart fx:id="threatLevelChart" VBox.vgrow="ALWAYS"/>
            </VBox>

            <!-- Right Side - Details -->
            <VBox spacing="10">
                <Label text="Species Details" styleClass="section-header"/>
                <TableView fx:id="speciesTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="speciesColumn" text="Species"/>
                        <TableColumn fx:id="threatLevelColumn" text="Threat Level"/>
                        <TableColumn fx:id="populationColumn" text="Population"/>
                        <TableColumn fx:id="trendColumn" text="Trend"/>
                    </columns>
                </TableView>
            </VBox>
        </SplitPane>

        <!-- Action Buttons -->
        <HBox spacing="15" alignment="CENTER">
            <Button fx:id="generateButton" text="Generate Report" onAction="#handleGenerateReport" styleClass="action-button"/>
            <Button fx:id="previewButton" text="Preview PDF" onAction="#handlePreviewPDF" styleClass="action-button"/>
            <Button fx:id="saveButton" text="Save PDF" onAction="#handleSavePDF" styleClass="action-button"/>
        </HBox>

        <!-- Progress Section -->
        <VBox spacing="10">
            <HBox spacing="10" alignment="CENTER_LEFT">
                <ProgressBar fx:id="progressBar" prefWidth="300"/>
                <Label fx:id="statusLabel" styleClass="status-label"/>
            </HBox>
            <TextArea fx:id="logArea" prefHeight="100" editable="false" styleClass="log-area" wrapText="true"/>
        </VBox>
    </VBox>
</AnchorPane>
